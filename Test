Sub ExportPivotTableToPPT()
    Dim pptApp As Object
    Dim pptPres As Object
    Dim pptSlide As Object
    Dim ws As Worksheet
    Dim pt As PivotTable
    Dim slideIndex As Integer
    Dim slideTitle As Object

    ' Set your worksheet containing the PivotTable
    Set ws = ThisWorkbook.Sheets("Sheet1") ' Change "Sheet1" to your sheet name

    ' Set your PivotTable
    Set pt = ws.PivotTables("PivotTable1") ' Change "PivotTable1" to your PivotTable name

    ' Initialize PowerPoint
    On Error Resume Next
    Set pptApp = GetObject(, "PowerPoint.Application")
    If pptApp Is Nothing Then
        Set pptApp = CreateObject("PowerPoint.Application")
    End If
    On Error GoTo 0

    pptApp.Visible = True

    ' Create a new presentation if none is open
    If pptApp.Presentations.Count = 0 Then
        Set pptPres = pptApp.Presentations.Add
    Else
        Set pptPres = pptApp.ActivePresentation
    End If

    ' Create a new slide with a blank layout
    slideIndex = pptPres.Slides.Count + 1
    Set pptSlide = pptPres.Slides.Add(slideIndex, ppLayoutText) ' 1 = ppLayoutText

    ' Check if the slide already has a title shape
    If pptSlide.Shapes.HasTitle Then
        Set slideTitle = pptSlide.Shapes.Title
    Else
        ' Add a title shape if none exists
        Set slideTitle = pptSlide.Shapes.AddTextbox(msoTextOrientationHorizontal, 0, 0, pptPres.PageSetup.SlideWidth, 50)
    End If

    ' Set the title for the slide
    slideTitle.TextFrame.TextRange.Text = "Pivot Table Export"

    ' Copy the PivotTable range
    pt.TableRange2.Copy

    ' Paste the PivotTable into PowerPoint
    pptSlide.Shapes.PasteSpecial DataType:=2 ' 2 = ppPasteEnhancedMetafile

    ' Position the pasted table
    With pptSlide.Shapes(pptSlide.Shapes.Count)
        .Left = 50
        .Top = 100
    End With

    ' Clean up
    Set pptSlide = Nothing
    Set pptPres = Nothing
    Set pptApp = Nothing
    Set ws = Nothing
    Set pt = Nothing

    MsgBox "Pivot Table exported to PowerPoint successfully!"
End Sub
